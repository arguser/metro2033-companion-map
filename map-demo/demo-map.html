<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>Metro</title>
		<meta charset="UTF-8">
		<meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>	

	<style type="text/css">
		html {
			margin:0;
			padding:0;
			font-family:arial,helvetica,sans-serif;
			color:#FFF;
			background-color:#001;
		}
		#canvasHolder {
			margin:10px;
			padding:0px;
			width:1800px;
			height:2000px;
			position:relative;
		}
		.metromap {
			position:absolute;
			margin:0px;
			padding:0px;
			width:1800px;
			height:2000px;
		}

		#lineCanvas {
			background-color:#FFF;
		}

		.station_link {
			display:block;
			position: absolute;
			cursor: pointer;
		}


	</style>

	<script type="text/javascript" src="utilities.js"></script>
	<script type="text/javascript" src="symbols.js"></script>
	<script type="text/javascript" src="demo_locations.js"></script>

	<script type="text/javascript">

		var animHolder;
		var animCurrentFrame; 
		var animFrames;

		var ctx = []; // holder for canvases
		var data_version = 3; // what data sets to use
		var name_set = 0; // what name set to use

		function drawMap() {

			// set label menu
			document.getElementById('name_set_dd').selectedIndex=name_set;

			// get canvas objects
			var canvas1 = document.getElementById('lineCanvas');
			ctx1 = canvas1.getContext('2d');
			var canvas2 = document.getElementById('stationCanvas');
			ctx2 = canvas2.getContext('2d');
			var canvas3 = document.getElementById('labelCanvas');
			ctx3 = canvas3.getContext('2d');
			var canvas4 = document.getElementById('effectCanvas');
			ctx4 = canvas4.getContext('2d');

			// put them in array
			ctx = [ctx1,ctx2,ctx3,ctx4];

			// initialise canvases
			for (i=0;i<ctx.length;i++) {
				ctx[i].clearRect(0, 0, 1800, 2000);
				ctx[i].scale(1,1);
				ctx[i].lineCap = 'round';
				ctx[i].textBaseline = 'middle'
			}

			// draw rail lines
			for (i=0;i<lines.length;i++) {
				thisLine = lines[i];
				drawLine(thisLine);
			}

			// draw interchanges
			interchange_2(705,368, 683,385); // Prospect Mir
 			interchange_2(521,823, 499,846); // October
			interchange_2(683,472, 698,489); // Chistye Prudy
			interchange_2(412,778, 388,778); // Park Kultry
			interchange_2(762,425, 762,450); // Komsomol
			interchange_2(605,1042, 574,1042); // Sebastapol
 
			// draw stations
			for (i=0;i<stations.length;i++) {
				ctx[2].clearRect(0, 0, 1800, 2000);
				thisStation = stations[i];
				station(thisStation['x_position'],thisStation['y_position'],thisStation['faction_id']);

				// create HTML Object for station
				clickable_station(thisStation['x_position'],thisStation['y_position'],thisStation['station_id']);
			}

			// label stations
			draw_features();

			// label stations
			print_station_labels();

		}

		
	</script>

	</head>
	<body onload="drawMap();">

		<form>
			<label for="name_set_dd">Labels</label>
			<select name="name_set_dd" id="name_set_dd" onchange="changeNames()">
				<option value="0">Russian (Latin)</option>
				<option value="1">Russian (Cyrillic)</option>
				<option value="2">English</option>
			</select>
			&nbsp;&nbsp;&nbsp;<input type="button" value="Highlight VDNKh" onclick="highlight_station(32);"/>
			&nbsp;&nbsp;&nbsp;<input type="button" value="Highlight Sukharev" onclick="highlight_station(37);"/>

		</form>

		<div id="canvasHolder">
			<canvas id="lineCanvas"    class="metromap" width="1800" height="2000"></canvas>
			<canvas id="stationCanvas" class="metromap" width="1800" height="2000"></canvas>
			<canvas id="labelCanvas"   class="metromap" width="1800" height="2000"></canvas>
			<canvas id="effectCanvas"  class="metromap" width="1800" height="2000"></canvas>
		</div>

	</body>
</html>